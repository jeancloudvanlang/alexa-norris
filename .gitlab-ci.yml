stages:
- build
- publish
- deploy

build:
  stage: build
  script:
  - ./gradlew clean test

publish:
  stage: publish
  artifacts:
    paths:
    - ./build/libs/*
    script:
    - ./gradlew fatJar

deploy:
  script:
  - pip install awscli
  - cd ./build/libs
  - zip -X -r ../../norris.zip *
  - cd ../..
  - aws lambda update-function-code --function-name ChuckFactor --zip-file fileb://norris.zip